pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--main
function _init()
 
 --functions
 _upd=upd_normal
 _drw=draw_normal
 _p_mov=nil
 t=0
 
 msg=""
 
 dirx={-1,1,0,0}
 diry={0,0,-1,1}
 
--player--
  p_x=14
  p_y=7
  p_ox=0
  p_oy=0
  p_iox=0
  p_ioy=0
  p_flipped=false
  p_ani={240,241,242,243}
  p_timer=0
end



function _update()
 t+=1
	_upd()
end

function _draw()
	_drw()
end





-->8
--updates
function upd_normal()
 for i=0,3 do
  if btnp(i) then
   moveplayer(dirx[i+1],diry[i+1])
   return
  end
 end
 if btnp(‚ùé) then
		gpio(1, 1)
	end
end

function upd_pturn()
 p_timer=min(p_timer+0.2,1)
 
 _p_mov()
 
 if p_timer==1 then
  _upd=upd_normal
 end
end


function upd_gameover()

end

function mov_walk()
 p_ox=p_iox*(1-p_timer)
 p_oy=p_ioy*(1-p_timer)
end

function mov_bump()
 
 if p_timer<0.5 then
 	p_ox=p_iox*p_timer
 	p_oy=p_ioy*p_timer
 else
 	p_ox=p_iox*(1-p_timer)
 	p_oy=p_ioy*(1-p_timer)
 end
end
-->8
--draws
function draw_normal()
cls()
map()

--sets color 000000 
--to be not trasnparent 
palt(0, false)
spr(
 get_frame(p_ani),
 p_x*8+p_ox,
 p_y*8+p_oy,
 1,
 1,
 p_flipped
 )



end
-->8
--tools
function get_frame(ani)
	return ani[flr(t/8)%4 + 1]

end

-->8
--gameplay

function moveplayer(dx,dy)
 local destx,desty=p_x+dx,p_y+dy
 local tile=mget(destx,desty)
 
 if dx<0 then
  p_flipped=true
 elseif dx>0 then
  p_flipped=false   
 end
  
 if fget(tile,0) then
  --wall
 	p_timer=0
	 
 	p_iox,p_ioy = 8*dx,8*dy
 	p_ox, p_oy = 0,0
 	
 	_upd=upd_pturn
 	_p_mov=mov_bump
 	
 	if tile == 13 then
 		mset(destx, desty,12)
 		sfx(1)
 	else
 		sfx(0)
 	end
 else 
 	p_x+=dx
 	p_y+=dy
 	
	 p_timer=0
	 
 	p_iox,p_ioy = -8*dx,-8*dy
 	p_ox, p_oy = p_iox,p_ioy
 	
 	_upd=upd_pturn
 	_p_mov=mov_walk
 end
end
__gfx__
00000000000000004044404040444040000000000000000000000000000000000000000000000000a0aaa0a00000000050555050a0aaa0a05000000055555550
0000000000000000000000000000000000000000000000000000000000000000000000000000000000aaa0000aaaaa0000000000000000005055000000000000
00700700000000004440444044404440000000000000000000000000000000000000000000000000a0aaa0a00a000a0050000050a0aaa0a05055055055000000
0007700000000000000000000000000000000000000000000000000000000000000000000000000000aaa0000a000a000000000000aaa0000055055055055000
00077000000000004044404000000000000000000000000000000000000000000000000000000000a0aaa0a00aaaaa0050000050a0aaa0a05000055055055050
0070070000400000000000000000000000000000000000000000000000000000000000000000000000aaa000000000000000000000aaa0005055000055055050
00000000000000004440444000000000000000000000000000000000000000000000000000000000a0aaa0a0aaaaaaa050000050a0aaa0a05055055055055050
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222220222222202222222006666660666666000666666006666600666666006662666066666660222266606662222066666660222266602222666066622220
22222220222222202222222066666660666666606666666066666660666666606662666066666660222266606662222066666660222266602222666066622220
22222220222222202222222066666660666666606666666066666660666666606622266066222660222226606622222066666660222266602222266066622220
22222220222222202222222066622220222266606662222066666660222266606622222022222220222222202222222022222220222266602222222066622220
22222660666666606622222066622220222266606662666066626660666266606622266066222660662226606622266022222660662266606666666066622660
22226660666666606662222066622220222266606662666066626660666266606662666066626660666266606662666022226660666266606666666066626660
22226660666666606662222066622220222266606662666066626660666266606662666066626660666266606662666022226660666266606666666066626660
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22226660066666006662222066622220222266600666666066626660666666006662666066626660666266606662666066626660666222206662666066666660
22226660666666606662222066622220222266606666666066626660666666606662666066626660666266606662666066626660666222206662666066666660
22226660666666606662222066622220222266606666666066222660666666606622266066222660662226606622266066622660662222206622666066666660
22226660666666606662222066622220222266606662222022222220222266602222222022222660222222202222222066622220222222202222666022222220
22226660666666606662222066666660666666606666666066222660666666606622266066222660222226606622222066622220666666602222666066222220
22226660666666606662222066666660666666606666666066626660666666606666666066626660222266606662222066622220666666602222666066622220
22226660066666006662222006666660666666000666666066626660666666006666666066626660222266606662222066622220666666602222666066622220
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22226660666666606662222066666660666266606662666066626660666266602222666066622220222266602222222066626660666222200000000000000000
22226660666666606662222066666660666266606662666066626660666266602222666066622220222266602222222066626660666222200000000000000000
22222660666666606622222066666660666266606662666066626660666266602222266066222220222226602222222066222660662222200000000000000000
22222220222222202222222022222220666266606662222066626660222266602222222022222220222222202222222022222220222222200000000000000000
22222220222222202222222066666660666266606666666066666660666666606622222022222660222226606622266022222220662222200000000000000000
22222220222222202222222066666660666266606666666066666660666666606662222022226660222266606662666022222220666222200000000000000000
22222220222222202222222066666660666266600666666006666600666666006662222022226660222266606662666022222220666222200000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000aaaa000000000000aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000aaaa0000a0a00000aaaa0000a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000a0a00000aaaa0000a0a00000aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a0aaaa000a00000000aaaa00a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aa0000000aa0aa000aa00000aa00aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
aa0aaa0a0aa0aa000aa0aa00aa00aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00a00a00000aa00000a00a00000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000010000000000000000000003000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1011111111111111111111111111111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001020101010101010101020101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200e020101010101010101010101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200102020202020202020d02010b012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20010d0101010101010101020103012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200202020202020201020102020d022200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200101010101010d010201020101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20010101010101020102010201010f2200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001010101010102010201020101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20010101010101020101010201010a2200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
200d020202020202010102020d02022200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001020101010102010101010102022200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001020102020102020d02020202022200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2001020102020102020101010101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20010d0102020101010101010101012200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3031313131313131313131313131313200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000030750307502d7502c75029750217501775010750077500275001750007500175020000250002500023000210002500024000260001e0001d00025000260001d000240002400025000230001e00021000
000500003b6502f650286502065019650106500665000600026000860005600026000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
